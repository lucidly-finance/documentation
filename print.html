<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Lucidly Finance Documentation</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="vaults.html"><strong aria-hidden="true">2.</strong> Vaults</a></li><li class="chapter-item expanded "><a href="borrowingandriskparameters.html"><strong aria-hidden="true">3.</strong> Borrowing and Risk Parameters</a></li><li class="chapter-item expanded "><a href="collateralassets.html"><strong aria-hidden="true">4.</strong> Collateral Assets</a></li><li class="chapter-item expanded "><a href="interestrates.html"><strong aria-hidden="true">5.</strong> Interest Rates and Price Stability</a></li><li class="chapter-item expanded "><a href="liquidationsandstabilitypool.html"><strong aria-hidden="true">6.</strong> Liquidations and Stability Pool</a></li><li class="chapter-item expanded "><a href="gauges.html"><strong aria-hidden="true">7.</strong> Gauges and DeMOs</a></li><li class="chapter-item expanded "><a href="governance.html"><strong aria-hidden="true">8.</strong> Governance</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lucidly Finance Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Stablecoins have always been an area of very intensive research and interest in decentralised finance. Most stablecoins in the ecosystem can be categorised into custodian, soft-pegged over-collateralized and under-collateralized algorithmic designs.</p>
<p>Custodian stablecoins are centralised institutions that allow deposits in fiat and other RWAs and issue tokens on the blockchain that are hard-pegged to the exact value of the currency. Hence a very centralised approach.
Soft-pegged over-collateralized stablecoins have different designs, the most popular amongst them are CDPs(Collateralized Debt Positions).</p>
<p>Depositors deposit an asset to issue a stable position at a premium. These positions get liquidated when the value of the collateral gets lower than the loan issued and depositors need to add more margin to prevent the same. This is a permissionless and decentralised approach and the requirement of a premium to issue stablecoin makes it hard to scale.</p>
<p>Under-collateralized algorithmic stablecoins are backed by endogenous assets and provide a highly trustless and scalable model that captures the early Bitcoin vision of decentralized money but with useful stability. They're extremely difficult to bootstrap and highly risky, as seen in the LUNA-UST crash.</p>
<p>We've come up with a novel mechanism of cross/isolated Vaults which allow depositors to hedge risks with multiple assets and allows integration of risk management strategies on top of the protocol without much gas overhead. Lucidly relies on a protocol managed stability pool as the primary mechanism to liquidate risky Vaults.</p>
<h3 id="ulcd"><a class="header" href="#ulcd">uLCD</a></h3>
<p>Lucidly Finance is an overcollateralised stablecoin lending protocol designed to offer efficient borrow rates and a robust dynamic interest rate to maintain peg. The first product is uLCD which is soft-pegged to USD.</p>
<p>The protocol uses governance to vote on gauges to use the collateral to earn yield on other defi money markets like yearn vaults, morpho aave, gearbox etc.</p>
<ul>
<li><a href="https://vitalik.ca/general/2022/05/25/stable.html">Good ol' Vitalik's post on stablecoins</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vaults"><a class="header" href="#vaults">Vaults</a></h1>
<p>The Lucidly Protocol uses chainlink oracles and Euler's isolated lending markets to allow users to adjust their risk tolerance according to the collateral they decide to use.</p>
<p>Users can deposit multiple collateral into their vaults and borrow a maximum amount of uLCD tokens calculated from their health factor. </p>
<p>Cross-margin enables users to hedge risks according to total notional value in the margin account.</p>
<p>A Vault is where the borrower takes out and maintains the $uLCD loan against multiple assets on the protocol. Every vault is linked to an individual ERC20 address and each address can have just one vault. </p>
<p>Lucidly Vaults are conceptually similar to the vaults or CDPs managed by other protocols. Each vault maintains two balances: One balance is the user debt denominated in ETH and the other balance is the net value of the users collateral equivalent to the total margin of all the assets (ETH, wStETH, APE, LINK, AVAX, etc.) supplied by the user, also denominated in ETH. </p>
<p>The vault’s collateral ratio is dependent on the above two balances of the vault. The amount of each balance could be altered by adding more collateral or by repaying the user debt. The vault could be closed anytime by paying off the complete debt + interest.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="borrowing-and-risk-parameters"><a class="header" href="#borrowing-and-risk-parameters">Borrowing and Risk Parameters</a></h1>
<p>Lucidly Finance offers dynamic interest rate loans aiming to be the most capital-efficient borrowing protocol. A user who needs liquid funds can use the protocol to lock up multiple assets listed on the protocol to borrow against the collateral and withdraw uLCD, which could be repaid at any future date.</p>
<p>Users can deposit multiple assets and borrow a certain amount of uLCD tokens. 
Each collateral has a certain LTV ratio (loan-to-value).</p>
<p>Each Vault has a single owner(can be an EOA or a contract) and a health factor that determines how much risk the owner assumes.</p>
<p><img src="./img/hf.png" alt="Health Factor" title="health factor" /></p>
<p>Any position that is under water and is eligible for liquidation if the health factor reached the liquidation threshold.</p>
<p>Cross collateral allows users to diversify their risk across multiple assets. At launch, the protocol is going to support the following assets as collateral:</p>
<ul>
<li><a href="https://etherscan.io/token/0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2">WETH</a></li>
<li><a href="https://etherscan.io/token/0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0#code">wstETH</a></li>
<li><a href="https://etherscan.io/token/0xae78736cd615f374d3085123a210448e74fc6393#code">rETH</a></li>
<li><a href="https://etherscan.io/token/0xD533a949740bb3306d119CC777fa900bA034cd52">CRV</a></li>
<li><a href="https://etherscan.io/token/0x0ab87046fBb341D058F17CBC4c1133F25a20a52f">gOHM</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="collateral-assets"><a class="header" href="#collateral-assets">Collateral Assets</a></h1>
<p>Assets are permissioned to be used as collateral by the governance and are priced using Chainlink oracles and Euler Finance isolated lending markets for select assets.</p>
<p>Every collateral asset to be whitelisted by the protocol has a few quantitative parameters which are analyzed for risk :</p>
<ul>
<li>Market Cap / Fully Diluted Market Cap</li>
<li>Trading Volume</li>
<li>Liquidity</li>
<li>Cost needed to manipulate a 30 minute TWAP</li>
</ul>
<p>Extensive analysis is to be performed by the core team before governance takes over regarding any asset whitelisting.</p>
<ul>
<li><a href="https://github.com/euler-xyz/uni-v3-twap-manipulation/blob/master/cost-of-attack.pdf">Euler Finance's paper on TWAP manipulation</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interest-rates-and-price-stability"><a class="header" href="#interest-rates-and-price-stability">Interest Rates and Price Stability</a></h1>
<p>Lucidly has a novel reactive interest rate mechanism that enforces peg stability by adjusting interest rates algorithmically, involving minimal governance in the process.</p>
<p>When uLCD is below the peg(i.e, the demand for uLCD is less as a result of too much supply), the interest rate increases, hence prompting Vault owners to repay their loan back. This increases demand for uLCD in the open market and hence will bring price up to 1 USD.</p>
<p>When uLCD is above peg(i.e, there is more demand for uLCD than supply), the interest rates decrease, hence incentivizing users to borrow more uLCD against their margin. This increases supply and hence will bring price down to 1 USD.</p>
<p>Theoretically, interest cost should tend towards infinity if the price of uLCD tends towards zero and vice versa. Interest rates should reflect market supply and demand. An Asset should cost more to borrow if there's more demand for it than supply and less for the opposite.</p>
<p>The interest rate is to be controlled programmatically by a <a href="https://en.wikipedia.org/wiki/PID_controller#PI_controller">PI controller</a> and the aim is to achieve the following goals in mind:</p>
<ul>
<li>
<p><em>Optimal operation</em> - The system must stay at an equilibrium state where the market price of 1 uLCD is 1 USD while holding the interest rate relatively constant.</p>
</li>
<li>
<p><em>Attractive interest rate for borrowers</em> - We want the interest rate to quickly react when the price deviates from 1 USD.</p>
</li>
</ul>
<p>Lucidly Finance uses a PI controller to determine rates. The interest rate for a loan at any point of time consists on a proportional and integral factor.</p>
<h3 id="derivation-for-the-interest-rate"><a class="header" href="#derivation-for-the-interest-rate">Derivation for the interest rate</a></h3>
<p>At any point of time, the ideal price of 1 uLCD should be 1 USD.</p>
<p>The peg deviation \( \Delta P \) at any point of time can be denoted by:</p>
<p>$$\Delta P = P_t - P_o$$</p>
<p>where \(P_o\) is 1 USD and \(P_t\) is the market price of 1 uLCD.</p>
<!-- The protocol will set tolarable values of \\(P_t\\) between 0.98 USD and 1.02 USD. So we assume \\(P_c\\) = 0.98 and \\(P_l\\) = 1.02 -->
<p>The controller is composed of the integral (\(r_I\)) and proportional (\(r_P\)) parts \(r_L\):</p>
<p>$$r = r_I + r_P$$</p>
<h3 id="integral-term"><a class="header" href="#integral-term">Integral term</a></h3>
<p>We need a controller that has adaptive behaviour. It should search for the interest rate that corresponds to the optimal price: when price is above peg, it should grow, otherwise it should go down. This is formulated below: </p>
<p>$$r_i(t) = k_i\int_0^t\Delta P~d\tau$$</p>
<p>where \(k_I\) &gt; 0 is a constant. The discrete form on the above equation is
$$r_I(t + \Delta t) = r_I(t) + k_I(\Delta P)\Delta t$$</p>
<h3 id="proportional-term"><a class="header" href="#proportional-term">Proportional term</a></h3>
<p>The proportional term \(r_P\) captures the following behaviour: when peg deviates below 1 USD, sharply increase the interest rate; when peg deviates below 1 USD, drop the interest rate. It is expressed by the formula</p>
<p>$$r_P(t) = k_P \Delta P$$</p>
<p>where \(k_P\) is a positive constant.</p>
<p>This approach is risky in a way that is \(k_P\) is not large enough, it may not succeed in pushing the peg back to 1 USD in case of price volatility. We need to assume a tolerable critical price on either side of the deviation beyond which \(r_P\) has more effect on the interest rate. </p>
<p>Let's assume we can tolerate the price of 1 uLCD between $0.98 and $1.02, these two prices are our critical prices.</p>
<p>Therefore, we need to make \(r_P\) adaptive in the following way:</p>
<p>$$r_P(t) = k_c\Delta P$$
$$r_P(t) = k_c(1+T_c(t))\Delta P, if |\Delta P| &gt; 0.02$$</p>
<p>Here \(T_c\) is a positive factor that grows while the peg stays above $1.02 or below $0.98 and decreses otherwise:</p>
<p>$$T_c(t+\Delta t) = \{T_c(t) + \beta \Delta t\}$$</p>
<!-- $$r_P(t) = k_P\Delta P, if |\Delta P| < 0.02$$ -->
<!-- $$r_i(t + \Delta t) = max\\{r_i(t) + k_i(\Delta P)\Delta t, r_lin(t)\\}$$ -->
<!-- $$\int_\Omega \nabla u \cdot \nabla v~dx = \int_\Omega fv~dx$$ -->
<ul>
<li>
<p><a href="https://www.imfs-frankfurt.de/fileadmin/user_upload/Events_2018/MMCI_Conference/Papers/09-Raymond_Hawkins-Monetary_Policy_and_PID_Control.pdf">Monetary Policy and PID Control</a></p>
</li>
<li>
<p><a href="https://gauntlet.network/reports/pid">Gauntlet's report on DeFi rates</a></p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="liquidations-and-stability-pool"><a class="header" href="#liquidations-and-stability-pool">Liquidations and Stability Pool</a></h1>
<p>Lucidly’s liquidation model provides relevant benefits from a user’s perspective with its design exploring relevant solutions.</p>
<p>One of the main issues for borrowing services is the fact that the protocol must always remains solvent: there are therefore, if necessary, liquidations to restore the balance. Liquidation of positions requires a certain infrastructure when it is the liquidators who do it directly, as on Maker, Compound or Aave. To optimize the process, the idea of having a liquidity “backstop” has emerged.</p>
<p>It is about having a reserve of funds, generally stablecoins that the protocol uses if necessary to manage liquidations: at Lucidly Finance, we call it the Stability Pool inspired from Liquity. The users who wish to do so can deposit their uLCD in this pool: they are remunerated in the asset that the protocol liquidates. Lucidly Finance will deploy a stability pool for each collateral that it supports.</p>
<p>The funds in the stability pool are used when necessary for liquidations. With quantified figures, the protocol runs the stability pool in a fully secure manner. Liquidations tend to happen mostly in case of a sharp drop in the total margin price of the assets stored in the vault. A position in the Stability Pool therefore allows one to profit from these juicy liquidations without having the skills or infrastructure to execute them.</p>
<p>The stability pool thus offers a rather gas-efficient and attractive native return option on uLCD. With a conservative collateral ratio, it may even be suitable for an almost entirely passive position. Rewards from the stability pool is distributed to depositors in a O(1) complexity.</p>
<p>The stability pool acts as the first shock absorber for liquidations in the protocol. However, if certain cases, if the debt amount cannot be covered by stability pool reserves, the protocol will put up the collateral up for a dutch auction.</p>
<p>The collateral in that case is sold off to the highest bidder and protocol takes a certain amount of the collateral in this case as a liquidation fee. This amount is dynamic, rather than a fixed discount percentage for the liquidator, we allow the discount to rise as a function of how under-water a position is. As the discount slowly increases, each would-be liquidator must decide whether or not to bid for a liquidation at the current discount on offer. Liquidator A might be profitable at 4%, but liquidator B might run a more efficient operation and be able to jump in sooner at 3.5%. The Dutch auction is aided by Uniswap TWAP oracles because a shock to the price does not bring with it a singular point at which every liquidator becomes profitable all at once. Instead, the price moves more smoothly over time leading to a continuum of opportunities to liquidate, which further helps to limit PGAs. Overall, this process should help to drive the discount price towards the marginal operating cost of liquidating a borrower.</p>
<ul>
<li><a href="https://github.com/liquity/liquity/blob/master/papers/Scalable_Reward_Distribution_with_Compounding_Stakes.pdf">Scalable Reward Distribution with Compounding Stakes</a></li>
<li><a href="https://arxiv.org/pdf/2201.03519.pdf">Maker liquidations 2.0</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gauges-and-defi-market-operations"><a class="header" href="#gauges-and-defi-market-operations">Gauges and Defi Market Operations</a></h1>
<p>DeFi Market Operations or DeMOs are operations that are voted upon by the users of the protocol as to where the collateral should be deposited to earn passive yield.</p>
<p>For example, the protocol as ETH as collateral. There are multiple passive earning strategies for WETH, i.e., yearn vaults, gearbox passive pools, instadapp lite vaults, morpho aave and much more.</p>
<p>Gauges are used to incentivize particular &quot;strategies&quot; and behaviors that are advantageous to the protocol such as increasing uLCD lending, deepening liquidity of certain pairs, or growing a partnership/integration between another project. </p>
<p>Listing of gauges will be permissioned by governance and must suffice two properties :</p>
<ul>
<li>Immediate withdrawal - as vaults could be closed anytime through users or liquidation.</li>
<li>High smart contract security - only highly proven staking opportunities can be utilized. </li>
</ul>
<p>bLCD(bonded LUCID) allocated to each gauge is referred to as it's &quot;gauge weight&quot;. Voters can distribute their voting power across multiple gauges or just one gauge.</p>
<ul>
<li>Users issue loans from the protocol and receive emissions.</li>
<li>They vote with LUCID on gauges for the collateral to make money.</li>
<li>Part of the yield is used to buy back and burn the LUCID token from open market.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="governance"><a class="header" href="#governance">Governance</a></h1>
<p>Lucidly finance is focused on building a decentralised protocol with a novel governance mechanism to provide efficient decision-making for the stakeholders of Lucidly Finance. </p>
<h3 id="lucid"><a class="header" href="#lucid">LUCID</a></h3>
<p>LUCID will be the core token of the protocol, handling all the proposals at governance level(LIPs).</p>
<p>Although most of the protocol activites require minimal governance, these are the areas that will fall under governance:</p>
<ul>
<li>Whitelisting of assets for collateral</li>
<li>Updating interest fee constants</li>
<li>Whitelisting of gauges</li>
</ul>
<p>Holders of LUCID buy bonds in a olympusdao mechanism. We'll be using <a href="https://bondprotocol.finance/">Bond Protocol</a> to facilitate protocol owned liquidity.</p>
<p>Bonded LUCID or bLUCID is used to vote on gauges and protocol governance.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </body>
</html>
